import{_ as S,m as b,a as g,r as m,o as r,b as i,d as s,e as o,w as d,F,k as R,t as _,j as x,l as w,f as u,n as p}from"./index-CgHBEOTy.js";import{c as h}from"./cartStore-CcZ1MGtz.js";import{s as V}from"./sweetAlertStore-w7mpYN6A.js";var j={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_NAME:"eatburgertest",BASE_URL:"/EatBurger/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:k,VITE_NAME:E}=j,D={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""},coupon:""}},methods:{...b(h,["getCarts"]),...b(V,["swalError"]),...b(V,["successToast"]),...b(V,["errorToast"]),createOrder(){const t=this.form;this.$http.post(`${k}/v2/api/${E}/order`,{data:t}).then(e=>{this.$refs.form.resetForm(),this.form.message="",this.getCarts(),this.$router.push(`/cartfinish/${e.data.orderId}`)}).catch(()=>{this.errorToast("お手数ですが、もう一度やり直してください")})},isPhone(t){const e=/^(0)[0-9]{11}$/;return t===""?"携帯電話番号は必須項目です":e.test(t)?!0:"有効な携帯電話番号ではありません"},useCoupon(t){const e={code:t};this.$http.post(`${k}/v2/api/${E}/coupon`,{data:e}).then(()=>{this.getCarts(),this.coupon="",this.successToast("クーポンを使用しました")}).catch(()=>{this.coupon="",this.errorToast("クーポンコードが正しくありません")})}},computed:{...g(h,["carts"]),...g(h,["final_total"]),...g(h,["total"])}},I={class:"container pt-5"},L={class:"d-flex flex-column d-md-none align-items-center mb-5"},M={class:"border border-secondary bg-secondary w-100 text-center py-2"},N=s("div",{class:"d-flex align-items-center"},[s("i",{class:"bi bi-caret-down-fill fs-1 text-secondary"})],-1),A={class:"border border-primary bg-primary w-100 text-center py-2"},B=s("div",{class:"d-flex align-items-center"},[s("i",{class:"bi bi-caret-down-fill fs-1 text-primary"})],-1),q={class:"border border-primary w-100 text-center py-2"},O={class:"d-none d-md-flex justify-content-center mb-5"},P={class:"border border-secondary bg-secondary px-5 py-4"},z=s("div",{class:"d-flex align-items-center mx-2"},[s("i",{class:"bi bi-caret-right-fill fs-1 text-secondary"})],-1),G={class:"border border-primary bg-primary px-5 py-4"},H=s("div",{class:"d-flex align-items-center mx-2"},[s("i",{class:"bi bi-caret-right-fill fs-1 text-primary"})],-1),J={class:"border border-primary px-5 py-4"},K={class:"row"},Q={class:"col-md-8"},W={class:"bg-white p-3 mb-3 mb-md-0"},X=s("div",{class:"mb-3"},[s("h2",null,"お客様情報")],-1),Y={class:"row justify-content-center"},Z={class:"mb-3"},$=s("label",{for:"name",class:"form-label"},"お名前",-1),ss={class:"mb-3"},es=s("label",{for:"address",class:"form-label"},"お届け先",-1),ts={class:"mb-3"},os=s("label",{for:"email",class:"form-label"},"メールアドレス",-1),ls={class:"mb-3"},as=s("label",{for:"tel",class:"form-label"},"携帯電話番号",-1),ns={class:"mb-3"},ds=s("label",{for:"message",class:"form-label"},"備考欄",-1),rs=s("div",{class:"text-end"},[s("button",{type:"submit",class:"btn btn-danger"},"注文を確認する")],-1),is={class:"col-md-4"},cs=s("div",{class:"bg-dark p-2"},[s("h3",{class:"text-center text-white"},"ご注文概要")],-1),ms={class:"bg-white p-3"},_s={class:"table align-middle mb-2"},us=s("thead",null,null,-1),fs={class:"text-primary fw-bold fs-6"},bs={class:"text-danger fs-5 text-end"},ps={class:"text-change fw-bold fs-5 text-end"},hs={key:0,class:"d-flex justify-content-between align-items-end mb-4"},vs=s("h4",{class:"fw-bold"},"合計",-1),ys={class:"text-danger fw-bold fs-5"},gs={key:1,class:"mt-3"},xs={class:"d-flex justify-content-between align-items-end mb-1"},ws=s("h4",{class:"fw-bold fs-5"},[s("del",null,"合計")],-1),Vs={class:"text-danger fw-bold fs-6"},ks={class:"d-flex justify-content-between align-items-end mb-4"},Es=s("h4",{class:"fw-bold fs-4"},"クーポン適用後合計",-1),Ts={class:"text-danger fw-bold fs-4"},Cs={key:2,class:"input-group mb-3"},Us=["disabled"],Ss={key:3,class:"input-group mb-3"},Fs=s("button",{class:"btn btn-dark",type:"button",id:"button-addon2",disabled:""}," 適用 ",-1),Rs=s("button",{type:"button",class:"btn btn-primary w-100 py-3 rounded-0"},[s("span",{class:"text-warning fw-bold fs-5"},"カートへ戻る")],-1);function js(t,e,Ds,Is,l,v){const c=m("sapn"),y=m("v-field"),f=m("error-message"),T=m("VField"),C=m("VForm"),U=m("RouterLink");return r(),i("div",I,[s("div",L,[s("div",M,[o(c,{class:"fs-4 text-white"},{default:d(()=>[u("1.カート")]),_:1})]),N,s("div",A,[o(c,{class:"fs-4 text-white"},{default:d(()=>[u("2.ご購入手続き")]),_:1})]),B,s("div",q,[o(c,{class:"fs-4"},{default:d(()=>[u("3.ご注文完了")]),_:1})])]),s("div",O,[s("div",P,[o(c,{class:"fs-4 text-white"},{default:d(()=>[u("1.カート")]),_:1})]),z,s("div",G,[o(c,{class:"fs-4 text-white"},{default:d(()=>[u("2.ご購入手続き")]),_:1})]),H,s("div",J,[o(c,{class:"fs-4"},{default:d(()=>[u("3.ご注文完了")]),_:1})])]),s("div",K,[s("div",Q,[s("div",W,[X,s("div",Y,[o(C,{ref:"form",onSubmit:v.createOrder},{default:d(({errors:a})=>[s("div",Z,[$,o(y,{id:"name",name:"お名前",type:"text",modelValue:l.form.user.name,"onUpdate:modelValue":e[0]||(e[0]=n=>l.form.user.name=n),class:p(["form-control",{"is-invalid":a.お名前}]),placeholder:"お名前を入力",rules:"required"},null,8,["modelValue","class"]),o(f,{name:"お名前",class:"invalid-feedback"})]),s("div",ss,[es,o(y,{id:"address",name:"お届け先",type:"text",modelValue:l.form.user.address,"onUpdate:modelValue":e[1]||(e[1]=n=>l.form.user.address=n),class:p(["form-control",{"is-invalid":a.お届け先}]),placeholder:"お届け先を入力",rules:"required"},null,8,["modelValue","class"]),o(f,{name:"お届け先",class:"invalid-feedback"})]),s("div",ts,[os,o(T,{id:"email",name:"メールアドレス",type:"email",modelValue:l.form.user.email,"onUpdate:modelValue":e[2]||(e[2]=n=>l.form.user.email=n),class:p(["form-control",{"is-invalid":a.メールアドレス}]),placeholder:"メールアドレスを入力",rules:"email|required"},null,8,["modelValue","class"]),o(f,{name:"メールアドレス",class:"invalid-feedback"})]),s("div",ls,[as,o(y,{id:"tel",name:"携帯電話番号",type:"text",modelValue:l.form.user.tel,"onUpdate:modelValue":e[3]||(e[3]=n=>l.form.user.tel=n),class:p(["form-control",{"is-invalid":a.携帯電話番号}]),placeholder:"携帯電話番号を入力",rules:v.isPhone},null,8,["modelValue","class","rules"]),o(f,{name:"携帯電話番号",class:"invalid-feedback"})]),s("div",ns,[ds,x(s("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[4]||(e[4]=n=>l.form.message=n)},null,512),[[w,l.form.message]])]),rs]),_:1},8,["onSubmit"])])])]),s("div",is,[cs,s("div",ms,[s("table",_s,[us,s("tbody",null,[(r(!0),i(F,null,R(t.carts,a=>(r(),i("tr",{key:a.id},[s("td",null,[s("span",fs,_(a.product.title),1)]),s("td",bs,"x "+_(a.qty),1),s("td",ps," ¥ "+_(Math.round(a.final_total)),1)]))),128))])]),t.final_total===t.total?(r(),i("div",hs,[vs,s("span",ys,"¥ "+_(t.total),1)])):(r(),i("div",gs,[s("div",xs,[ws,s("span",Vs,[s("del",null,"¥ "+_(t.total),1)])]),s("div",ks,[Es,s("span",Ts,"¥ "+_(Math.round(t.final_total)),1)])])),t.final_total===t.total?(r(),i("div",Cs,[x(s("input",{type:"text",class:"form-control",placeholder:"クーポンコードを入力","onUpdate:modelValue":e[5]||(e[5]=a=>l.coupon=a),"aria-label":"クーポンコードを入力","aria-describedby":"button-addon",disabled:t.carts.final_total!==t.carts.total},null,8,Us),[[w,l.coupon]]),s("button",{class:"btn btn-dark",type:"button",id:"button-addon",onClick:e[6]||(e[6]=a=>v.useCoupon(l.coupon))}," 適用 ")])):(r(),i("div",Ss,[x(s("input",{type:"text",class:"form-control",placeholder:"クーポンが適用されました","onUpdate:modelValue":e[7]||(e[7]=a=>l.coupon=a),"aria-label":"クーポンが適用されました","aria-describedby":"button-addon2",disabled:""},null,512),[[w,l.coupon]]),Fs]))]),o(U,{to:"/cart"},{default:d(()=>[Rs]),_:1})])])])}const As=S(D,[["render",js]]);export{As as default};
